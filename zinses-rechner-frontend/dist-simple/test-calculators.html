<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¾·å›½é‡‘èè®¡ç®—å™¨åŠŸèƒ½éªŒè¯</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .test-section {
            background: white;
            margin: 20px 0;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 4px;
        }
        .test-pass {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-fail {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background-color: #0056b3;
        }
        .summary {
            background-color: #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <h1>ğŸ§® å¾·å›½é‡‘èè®¡ç®—å™¨åŠŸèƒ½éªŒè¯</h1>
    
    <div class="summary" id="summary">
        <h3>æµ‹è¯•æ‘˜è¦</h3>
        <p>ç‚¹å‡»ä¸‹é¢çš„æŒ‰é’®å¼€å§‹æµ‹è¯•å„ä¸ªè®¡ç®—å™¨çš„åŠŸèƒ½</p>
    </div>

    <div class="test-section">
        <h2>ğŸ”„ å¤åˆ©è®¡ç®—å™¨ï¼ˆZinseszins-Rechnerï¼‰</h2>
        <button onclick="testCompoundInterest()">æµ‹è¯•å¤åˆ©è®¡ç®—å™¨</button>
        <div id="compound-results"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ¦ è´·æ¬¾è®¡ç®—å™¨ï¼ˆDarlehensrechnerï¼‰</h2>
        <button onclick="testLoanCalculator()">æµ‹è¯•è´·æ¬¾è®¡ç®—å™¨</button>
        <div id="loan-results"></div>
    </div>

    <div class="test-section">
        <h2>ğŸ  æˆ¿è´·è®¡ç®—å™¨ï¼ˆBaufinanzierungsrechnerï¼‰</h2>
        <button onclick="testMortgageCalculator()">æµ‹è¯•æˆ¿è´·è®¡ç®—å™¨</button>
        <div id="mortgage-results"></div>
    </div>

    <div class="test-section">
        <button onclick="runAllTests()" style="background-color: #28a745; font-size: 16px; padding: 15px 30px;">
            ğŸš€ è¿è¡Œæ‰€æœ‰æµ‹è¯•
        </button>
    </div>

    <script>
        let testResults = [];

        function addTestResult(calculatorName, testName, passed, expected, actual, error = null) {
            testResults.push({
                calculatorName,
                testName,
                passed,
                expected,
                actual,
                error
            });
        }

        function displayResult(containerId, testName, passed, details) {
            const container = document.getElementById(containerId);
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${passed ? 'test-pass' : 'test-fail'}`;
            resultDiv.innerHTML = `
                <strong>${passed ? 'âœ…' : 'âŒ'} ${testName}</strong><br>
                ${details}
            `;
            container.appendChild(resultDiv);
        }

        async function testCompoundInterest() {
            const container = document.getElementById('compound-results');
            container.innerHTML = '<p>ğŸ”„ æµ‹è¯•å¤åˆ©è®¡ç®—å™¨...</p>';

            try {
                // æ¨¡æ‹Ÿå¤åˆ©è®¡ç®—
                const principal = 10000;
                const monthlyPayment = 500;
                const annualRate = 4.0;
                const years = 10;

                // ç®€åŒ–çš„å¤åˆ©è®¡ç®—å…¬å¼
                const monthlyRate = annualRate / 100 / 12;
                const totalMonths = years * 12;
                
                // è®¡ç®—å¤åˆ©
                let futureValue = principal;
                for (let i = 0; i < totalMonths; i++) {
                    futureValue = (futureValue + monthlyPayment) * (1 + monthlyRate);
                }

                const totalContributions = principal + (monthlyPayment * totalMonths);
                const totalInterest = futureValue - totalContributions;

                // éªŒè¯æµ‹è¯•
                const test1 = futureValue > totalContributions;
                const test2 = totalInterest > 0;
                const test3 = futureValue > 80000 && futureValue < 120000; // åˆç†èŒƒå›´

                displayResult('compound-results', 'æœ€ç»ˆé‡‘é¢å¤§äºæ€»è´¡çŒ®', test1, 
                    `æœ€ç»ˆé‡‘é¢: â‚¬${futureValue.toFixed(2)}, æ€»è´¡çŒ®: â‚¬${totalContributions.toFixed(2)}`);
                
                displayResult('compound-results', 'äº§ç”Ÿæ­£åˆ©æ¯æ”¶ç›Š', test2, 
                    `åˆ©æ¯æ”¶ç›Š: â‚¬${totalInterest.toFixed(2)}`);
                
                displayResult('compound-results', 'è®¡ç®—ç»“æœåœ¨åˆç†èŒƒå›´', test3, 
                    `æœ€ç»ˆé‡‘é¢: â‚¬${futureValue.toFixed(2)} (é¢„æœŸ: â‚¬80,000 - â‚¬120,000)`);

                addTestResult('å¤åˆ©è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', test1 && test2 && test3, 'success', 'success');

            } catch (error) {
                displayResult('compound-results', 'è®¡ç®—é”™è¯¯', false, `é”™è¯¯: ${error.message}`);
                addTestResult('å¤åˆ©è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', false, 'success', error.message);
            }
        }

        async function testLoanCalculator() {
            const container = document.getElementById('loan-results');
            container.innerHTML = '<p>ğŸ”„ æµ‹è¯•è´·æ¬¾è®¡ç®—å™¨...</p>';

            try {
                // æ¨¡æ‹Ÿè´·æ¬¾è®¡ç®—
                const principal = 200000;
                const annualRate = 3.5;
                const years = 20;

                // ç­‰é¢æœ¬æ¯æœˆä¾›è®¡ç®—
                const monthlyRate = annualRate / 100 / 12;
                const totalMonths = years * 12;
                const monthlyPayment = principal * (monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / 
                                     (Math.pow(1 + monthlyRate, totalMonths) - 1);

                const totalPayment = monthlyPayment * totalMonths;
                const totalInterest = totalPayment - principal;

                // éªŒè¯æµ‹è¯•
                const test1 = monthlyPayment > 800 && monthlyPayment < 2000;
                const test2 = totalInterest > 0;
                const test3 = totalPayment > principal;

                displayResult('loan-results', 'æœˆä¾›é‡‘é¢åˆç†', test1, 
                    `æœˆä¾›: â‚¬${monthlyPayment.toFixed(2)} (é¢„æœŸ: â‚¬800 - â‚¬2,000)`);
                
                displayResult('loan-results', 'äº§ç”Ÿåˆ©æ¯æˆæœ¬', test2, 
                    `æ€»åˆ©æ¯: â‚¬${totalInterest.toFixed(2)}`);
                
                displayResult('loan-results', 'æ€»è¿˜æ¬¾å¤§äºæœ¬é‡‘', test3, 
                    `æ€»è¿˜æ¬¾: â‚¬${totalPayment.toFixed(2)}, æœ¬é‡‘: â‚¬${principal.toFixed(2)}`);

                addTestResult('è´·æ¬¾è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', test1 && test2 && test3, 'success', 'success');

            } catch (error) {
                displayResult('loan-results', 'è®¡ç®—é”™è¯¯', false, `é”™è¯¯: ${error.message}`);
                addTestResult('è´·æ¬¾è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', false, 'success', error.message);
            }
        }

        async function testMortgageCalculator() {
            const container = document.getElementById('mortgage-results');
            container.innerHTML = '<p>ğŸ”„ æµ‹è¯•æˆ¿è´·è®¡ç®—å™¨...</p>';

            try {
                // æ¨¡æ‹Ÿæˆ¿è´·è®¡ç®—
                const purchasePrice = 400000;
                const downPayment = 80000;
                const landTransferTaxRate = 5.0;
                const notaryRate = 1.5;
                const realEstateAgentRate = 3.57;
                const monthlyIncome = 4000;

                // è®¡ç®—å¾·å›½è´­æˆ¿æˆæœ¬
                const landTransferTax = purchasePrice * (landTransferTaxRate / 100);
                const notaryFees = purchasePrice * (notaryRate / 100);
                const agentFees = purchasePrice * (realEstateAgentRate / 100);
                const totalCosts = purchasePrice + landTransferTax + notaryFees + agentFees;

                const loanAmount = purchasePrice - downPayment;
                const monthlyRate = 3.8 / 100 / 12;
                const totalMonths = 25 * 12;
                const monthlyPayment = loanAmount * (monthlyRate * Math.pow(1 + monthlyRate, totalMonths)) / 
                                     (Math.pow(1 + monthlyRate, totalMonths) - 1);

                const affordabilityRatio = monthlyPayment / monthlyIncome;

                // éªŒè¯æµ‹è¯•
                const test1 = landTransferTax === 20000; // 5% of 400,000
                const test2 = affordabilityRatio < 0.5; // è´Ÿæ‹…èƒ½åŠ›åˆç†
                const test3 = totalCosts > purchasePrice; // æ€»æˆæœ¬å¤§äºæˆ¿ä»·

                displayResult('mortgage-results', 'åœŸåœ°è½¬è®©ç¨è®¡ç®—æ­£ç¡®', test1, 
                    `åœŸåœ°è½¬è®©ç¨: â‚¬${landTransferTax.toFixed(2)} (é¢„æœŸ: â‚¬20,000)`);
                
                displayResult('mortgage-results', 'è´Ÿæ‹…èƒ½åŠ›æ¯”ç‡åˆç†', test2, 
                    `è´Ÿæ‹…æ¯”ç‡: ${(affordabilityRatio * 100).toFixed(1)}% (åº” < 50%)`);
                
                displayResult('mortgage-results', 'æ€»æˆæœ¬åŒ…å«è´­æˆ¿è´¹ç”¨', test3, 
                    `æ€»æˆæœ¬: â‚¬${totalCosts.toFixed(2)}, æˆ¿ä»·: â‚¬${purchasePrice.toFixed(2)}`);

                addTestResult('æˆ¿è´·è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', test1 && test2 && test3, 'success', 'success');

            } catch (error) {
                displayResult('mortgage-results', 'è®¡ç®—é”™è¯¯', false, `é”™è¯¯: ${error.message}`);
                addTestResult('æˆ¿è´·è®¡ç®—å™¨', 'åŸºç¡€åŠŸèƒ½', false, 'success', error.message);
            }
        }

        async function runAllTests() {
            testResults = [];
            document.getElementById('compound-results').innerHTML = '';
            document.getElementById('loan-results').innerHTML = '';
            document.getElementById('mortgage-results').innerHTML = '';

            await testCompoundInterest();
            await testLoanCalculator();
            await testMortgageCalculator();

            updateSummary();
        }

        function updateSummary() {
            const totalTests = testResults.length;
            const passedTests = testResults.filter(r => r.passed).length;
            const successRate = totalTests > 0 ? ((passedTests / totalTests) * 100).toFixed(1) : 0;

            document.getElementById('summary').innerHTML = `
                <h3>ğŸ“Š æµ‹è¯•ç»“æœæ‘˜è¦</h3>
                <p><strong>æ€»æµ‹è¯•æ•°:</strong> ${totalTests}</p>
                <p><strong>é€šè¿‡æµ‹è¯•:</strong> ${passedTests}</p>
                <p><strong>å¤±è´¥æµ‹è¯•:</strong> ${totalTests - passedTests}</p>
                <p><strong>æˆåŠŸç‡:</strong> ${successRate}%</p>
                <p style="color: ${successRate == 100 ? 'green' : 'orange'};">
                    ${successRate == 100 ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼' : 'âš ï¸ éƒ¨åˆ†æµ‹è¯•éœ€è¦å…³æ³¨'}
                </p>
            `;
        }

        // é¡µé¢åŠ è½½å®Œæˆåçš„åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ§® å¾·å›½é‡‘èè®¡ç®—å™¨éªŒè¯é¡µé¢å·²åŠ è½½');
            console.log('ç‚¹å‡»æŒ‰é’®å¼€å§‹æµ‹è¯•å„ä¸ªè®¡ç®—å™¨çš„åŠŸèƒ½');
        });
    </script>
</body>
</html>
